%%%
%%% moretype.sty -- Typography
%%%

% Avoid widows, orphans, and lines sticking into the margin
\clubpenalty=500
\widowpenalty=1000
\tolerance=300

% Set a point size of 11.75 and leading of 15pt for the body text
\renewcommand\Large{\@setfontsize\Large{16pt}{20pt}}
\renewcommand\large{\@setfontsize\large{15pt}{18pt}}
\renewcommand\normalsize{\@setfontsize\normalsize{11.75pt}{15pt}}
\renewcommand\small{\@setfontsize\small{10pt}{13pt}}

% Create \newthought and \longnewthought commands for starting a new section
% without a section heading. It adds a little vertical space and sets three or
% four words in all small caps.
\def\newthought #1 #2 #3 {\vspace{15pt plus 5pt minus 2pt}\noindent {\lowercaps{#1}} {\lowercaps{#2}} {\lowercaps{#3}} }
\def\longnewthought #1 #2 #3 #4 {\vspace{15pt plus 5pt minus 2pt}\noindent {\lowercaps{#1}} {\lowercaps{#2}} {\lowercaps{#3}} {\lowercaps{#4}} }

% Microtypographic awesomeness!
\RequirePackage[final]{microtype}

% Commands for letterspaced capitals
\newcommand{\lowercaps}[1]{
  \textsc{\addfontfeature{
    Letters={UppercaseSmallCaps}
  }#1}
}
\newcommand{\uppercaps}[1]{
  \textsc{\addfontfeature{
    Letters={Uppercase},
    Kerning={Uppercase},
    LetterSpace=15
  }\MakeTextUppercase{#1}}
}

% Command for abbreviations and acronyms
\newcommand{\abbr}[1]{\lowercaps{#1}}

% Command for fancier ampersand
\newcommand{\oldand}{\textit{\&}}

% Allow loading system fonts
\RequirePackage[no-math]{fontspec}

% Settings that apply to all fonts
\defaultfontfeatures{
  Numbers={OldStyle, Proportional}, % Use proportional text figures
  SmallCapsFeatures={               % Letterspace small caps
    LetterSpace=8.0
  }
}

% Scala Sans from Typekit
% We set scale to one here because Arno is pretty small in its font file
\setsansfont[Scale=1]{Scala Sans Pro}

% Arno Pro from Typekit
% Match x-height to Scala Sans
\setromanfont[Scale=MatchLowercase]{Arno Pro}

% Fira Mono, (you guessed it!) from Typekit
\setmonofont[
    Numbers={Monospaced}, % Use monospaced numbers
    Scale=MatchLowercase  % Match size to Scala Sans
]{Fira Mono OT}

% Set up swash italics
\newfontface\Swash{Arno Pro}[Contextuals=Swash]
\DeclareTextFontCommand{\textsw}{\Swash}

% Generate math fonts from system fonts
\RequirePackage[italic]{mathastext}

% Use tabular figures in some places
\RequirePackage[ % Use them for ...
  eqno,          % equation numbers
  enum,          % enumerate item labels
  bib,           % bibliography item labels
  lineno         % line numbers
]{tabfigures}

% Same amount of space between sentences as between words
\frenchspacing

% Intelligently suppress ligatures
\RequirePackage{selnolig}

% Suppress purely ornamental Th ligaure
\nolig{Th}{T|h}

